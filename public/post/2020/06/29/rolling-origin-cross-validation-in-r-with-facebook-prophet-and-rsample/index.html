<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Evaluating forecast models using rolling origin cross validation | Abnormal Distributions</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
  </head>

  <body>
    <nav>
    <ul class="menu">
      
      <li><a href="/">Home</a></li>
      
      <li><a href="/post/">All Posts</a></li>
      
      <li><a href="/categories/">By Topic</a></li>
      
    </ul>
    <hr/>
    </nav>

<div class="article-meta">
<h1><span class="title">Evaluating forecast models using rolling origin cross validation</span></h1>
<h2 class="author">Danny Morris</h2>
<h2 class="date">2020/06/29</h2>
</div>

<main>

<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/plotly-binding/plotly.js"></script>
<script src="/rmarkdown-libs/typedarray/typedarray.min.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="/rmarkdown-libs/crosstalk/js/crosstalk.min.js"></script>
<link href="/rmarkdown-libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="/rmarkdown-libs/plotly-main/plotly-latest.min.js"></script>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<div id="TOC">
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#packages">Packages</a></li>
<li><a href="#data">Data</a></li>
<li><a href="#configure-rocv-splits">Configure ROCV splits</a></li>
<li><a href="#visualize-rocv-strategy">Visualize ROCV strategy</a></li>
<li><a href="#run-rocv">Run ROCV</a></li>
<li><a href="#results">Results</a><ul>
<li><a href="#distribution-of-mae">Distribution of MAE</a></li>
<li><a href="#visualize-predictions">Visualize predictions</a></li>
</ul></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
</div>

<div id="overview" class="section level2">
<h2>Overview</h2>
<p>Rolling origin cross validation (ROCV) is a technique for evaluating time series forecasting models by presenting the model with different subsets of data and measuring performance. This idea is discussed in <a href="https://otexts.com/fpp2/accuracy.html">Forecasting: Principles and Practice</a>. ROCV is also known as “walk-forward” validation. The basic idea is to train and test a forecast model on initial splits, then for each subsequent training iteration these splits are shifted forward by a user-defined shift size. The forward walk continues until all available data is exhausted. This robust evaluation strategy measures the model’s ability to learn under changing conditions.</p>
<p>This strategy is applicable to any statistical or predictive forecasting task. Examples include demand forecasting, workforce planning, sales, etc. It allows for very flexible and robust training and evaluation. Both are essential to producing a valid, high quality forecast model.</p>
</div>
<div id="packages" class="section level2">
<h2>Packages</h2>
<p>This post uses <a href="https://rsample.tidymodels.org/">rsample</a> from the tidymodels framework for generating ROCV splits. The <a href="https://facebook.github.io/prophet/">prophet</a> forecasting library developed by Facebook is used for model fitting.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># tidyverse</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">library</span>(prophet)</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">library</span>(rsample)</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">library</span>(yardstick)</a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw">library</span>(plotly)</a></code></pre></div>
</div>
<div id="data" class="section level2">
<h2>Data</h2>
<p>The data contains a sample of daily health insurance claims.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">claims &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;sample_claims.csv&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">PMPM =</span> Claims<span class="op">/</span>Population) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="st">  </span><span class="kw">select</span>(<span class="dt">ds =</span> Date,</a>
<a class="sourceLine" id="cb2-4" title="4">         <span class="dt">y =</span> PMPM)</a>
<a class="sourceLine" id="cb2-5" title="5"></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="kw">plot_ly</span>(<span class="dt">data =</span> claims, <span class="dt">x =</span> <span class="op">~</span>ds, <span class="dt">y =</span> <span class="op">~</span>y, <span class="dt">mode =</span> <span class="st">&quot;lines&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="st">  </span><span class="kw">layout</span>(<span class="dt">title =</span> <span class="st">&quot;Daily insurance claims PMPM&quot;</span>)</a></code></pre></div>
<div id="htmlwidget-1" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"visdat":{"3034565768e5":["function () ","plotlyVisDat"]},"cur_data":"3034565768e5","attrs":{"3034565768e5":{"x":{},"y":{},"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20]}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Daily insurance claims PMPM","xaxis":{"domain":[0,1],"automargin":true,"title":"ds"},"yaxis":{"domain":[0,1],"automargin":true,"title":"y"},"hovermode":"closest","showlegend":false},"source":"A","config":{"showSendToCloud":false},"data":[{"x":["2016-01-01","2016-01-02","2016-01-03","2016-01-04","2016-01-05","2016-01-06","2016-01-07","2016-01-08","2016-01-09","2016-01-10","2016-01-11","2016-01-12","2016-01-13","2016-01-14","2016-01-15","2016-01-16","2016-01-17","2016-01-18","2016-01-19","2016-01-20","2016-01-21","2016-01-22","2016-01-23","2016-01-24","2016-01-25","2016-01-26","2016-01-27","2016-01-28","2016-01-29","2016-01-30","2016-01-31","2016-02-01","2016-02-02","2016-02-03","2016-02-04","2016-02-05","2016-02-06","2016-02-07","2016-02-08","2016-02-09","2016-02-10","2016-02-11","2016-02-12","2016-02-13","2016-02-14","2016-02-15","2016-02-16","2016-02-17","2016-02-18","2016-02-19","2016-02-20","2016-02-21","2016-02-22","2016-02-23","2016-02-24","2016-02-25","2016-02-26","2016-02-27","2016-02-28","2016-02-29","2016-03-01","2016-03-02","2016-03-03","2016-03-04","2016-03-05","2016-03-06","2016-03-07","2016-03-08","2016-03-09","2016-03-10","2016-03-11","2016-03-12","2016-03-13","2016-03-14","2016-03-15","2016-03-16","2016-03-17","2016-03-18","2016-03-19","2016-03-20","2016-03-21","2016-03-22","2016-03-23","2016-03-24","2016-03-25","2016-03-26","2016-03-27","2016-03-28","2016-03-29","2016-03-30","2016-03-31","2016-04-01","2016-04-02","2016-04-03","2016-04-04","2016-04-05","2016-04-06","2016-04-07","2016-04-08","2016-04-09","2016-04-10","2016-04-11","2016-04-12","2016-04-13","2016-04-14","2016-04-15","2016-04-16","2016-04-17","2016-04-18","2016-04-19","2016-04-20","2016-04-21","2016-04-22","2016-04-23","2016-04-24","2016-04-25","2016-04-26","2016-04-27","2016-04-28","2016-04-29","2016-04-30","2016-05-01","2016-05-02","2016-05-03","2016-05-04","2016-05-05","2016-05-06","2016-05-07","2016-05-08","2016-05-09","2016-05-10","2016-05-11","2016-05-12","2016-05-13","2016-05-14","2016-05-15","2016-05-16","2016-05-17","2016-05-18","2016-05-19","2016-05-20","2016-05-21","2016-05-22","2016-05-23","2016-05-24","2016-05-25","2016-05-26","2016-05-27","2016-05-28","2016-05-29","2016-05-30","2016-05-31","2016-06-01","2016-06-02","2016-06-03","2016-06-04","2016-06-05","2016-06-06","2016-06-07","2016-06-08","2016-06-09","2016-06-10","2016-06-11","2016-06-12","2016-06-13","2016-06-14","2016-06-15","2016-06-16","2016-06-17","2016-06-18","2016-06-19","2016-06-20","2016-06-21","2016-06-22","2016-06-23","2016-06-24","2016-06-25","2016-06-26","2016-06-27","2016-06-28","2016-06-29","2016-06-30","2016-07-01","2016-07-02","2016-07-03","2016-07-04","2016-07-05","2016-07-06","2016-07-07","2016-07-08","2016-07-09","2016-07-10","2016-07-11","2016-07-12","2016-07-13","2016-07-14","2016-07-15","2016-07-16","2016-07-17","2016-07-18","2016-07-19","2016-07-20","2016-07-21","2016-07-22","2016-07-23","2016-07-24","2016-07-25","2016-07-26","2016-07-27","2016-07-28","2016-07-29","2016-07-30","2016-07-31","2016-08-01","2016-08-02","2016-08-03","2016-08-04","2016-08-05","2016-08-06","2016-08-07","2016-08-08","2016-08-09","2016-08-10","2016-08-11","2016-08-12","2016-08-13","2016-08-14","2016-08-15","2016-08-16","2016-08-17","2016-08-18","2016-08-19","2016-08-20","2016-08-21","2016-08-22","2016-08-23","2016-08-24","2016-08-25","2016-08-26","2016-08-27","2016-08-28","2016-08-29","2016-08-30","2016-08-31","2016-09-01","2016-09-02","2016-09-03","2016-09-04","2016-09-05","2016-09-06","2016-09-07","2016-09-08","2016-09-09","2016-09-10","2016-09-11","2016-09-12","2016-09-13","2016-09-14","2016-09-15","2016-09-16","2016-09-17","2016-09-18","2016-09-19","2016-09-20","2016-09-21","2016-09-22","2016-09-23","2016-09-24","2016-09-25","2016-09-26","2016-09-27","2016-09-28","2016-09-29","2016-09-30","2016-10-01","2016-10-02","2016-10-03","2016-10-04","2016-10-05","2016-10-06","2016-10-07","2016-10-08","2016-10-09","2016-10-10","2016-10-11","2016-10-12","2016-10-13","2016-10-14","2016-10-15","2016-10-16","2016-10-17","2016-10-18","2016-10-19","2016-10-20","2016-10-21","2016-10-22","2016-10-23","2016-10-24","2016-10-25","2016-10-26","2016-10-27","2016-10-28","2016-10-29","2016-10-30","2016-10-31","2016-11-01","2016-11-02","2016-11-03","2016-11-04","2016-11-05","2016-11-06","2016-11-07","2016-11-08","2016-11-09","2016-11-10","2016-11-11","2016-11-12","2016-11-13","2016-11-14","2016-11-15","2016-11-16","2016-11-17","2016-11-18","2016-11-19","2016-11-20","2016-11-21","2016-11-22","2016-11-23","2016-11-24","2016-11-25","2016-11-26","2016-11-27","2016-11-28","2016-11-29","2016-11-30","2016-12-01","2016-12-02","2016-12-03","2016-12-04","2016-12-05","2016-12-06","2016-12-07","2016-12-08","2016-12-09","2016-12-10","2016-12-11","2016-12-12","2016-12-13","2016-12-14","2016-12-15","2016-12-16","2016-12-17","2016-12-18","2016-12-19","2016-12-20","2016-12-21","2016-12-22","2016-12-23","2016-12-24","2016-12-25","2016-12-26","2016-12-27","2016-12-28","2016-12-29","2016-12-30","2016-12-31","2017-01-01","2017-01-02","2017-01-03","2017-01-04","2017-01-05","2017-01-06","2017-01-07","2017-01-08","2017-01-09","2017-01-10","2017-01-11","2017-01-12","2017-01-13","2017-01-14","2017-01-15","2017-01-16","2017-01-17","2017-01-18","2017-01-19","2017-01-20","2017-01-21","2017-01-22","2017-01-23","2017-01-24","2017-01-25","2017-01-26","2017-01-27","2017-01-28","2017-01-29","2017-01-30","2017-01-31","2017-02-01","2017-02-02","2017-02-03","2017-02-04","2017-02-05","2017-02-06","2017-02-07","2017-02-08","2017-02-09","2017-02-10","2017-02-11","2017-02-12","2017-02-13","2017-02-14","2017-02-15","2017-02-16","2017-02-17","2017-02-18","2017-02-19","2017-02-20","2017-02-21","2017-02-22","2017-02-23","2017-02-24","2017-02-25","2017-02-26","2017-02-27","2017-02-28","2017-03-01","2017-03-02","2017-03-03","2017-03-04","2017-03-05","2017-03-06","2017-03-07","2017-03-08","2017-03-09","2017-03-10","2017-03-11","2017-03-12","2017-03-13","2017-03-14","2017-03-15","2017-03-16","2017-03-17","2017-03-18","2017-03-19","2017-03-20","2017-03-21","2017-03-22","2017-03-23","2017-03-24","2017-03-25","2017-03-26","2017-03-27","2017-03-28","2017-03-29","2017-03-30","2017-03-31","2017-04-01","2017-04-02","2017-04-03","2017-04-04","2017-04-05","2017-04-06","2017-04-07","2017-04-08","2017-04-09","2017-04-10","2017-04-11","2017-04-12","2017-04-13","2017-04-14","2017-04-15","2017-04-16","2017-04-17","2017-04-18","2017-04-19","2017-04-20","2017-04-21","2017-04-22","2017-04-23","2017-04-24","2017-04-25","2017-04-26","2017-04-27","2017-04-28","2017-04-29","2017-04-30","2017-05-01","2017-05-02","2017-05-03","2017-05-04","2017-05-05","2017-05-06","2017-05-07","2017-05-08","2017-05-09","2017-05-10","2017-05-11","2017-05-12","2017-05-13","2017-05-14","2017-05-15","2017-05-16","2017-05-17","2017-05-18","2017-05-19","2017-05-20","2017-05-21","2017-05-22","2017-05-23","2017-05-24","2017-05-25","2017-05-26","2017-05-27","2017-05-28","2017-05-29","2017-05-30","2017-05-31","2017-06-01","2017-06-02","2017-06-03","2017-06-04","2017-06-05","2017-06-06","2017-06-07","2017-06-08","2017-06-09","2017-06-10","2017-06-11","2017-06-12","2017-06-13","2017-06-14","2017-06-15","2017-06-16","2017-06-17","2017-06-18","2017-06-19","2017-06-20","2017-06-21","2017-06-22","2017-06-23","2017-06-24","2017-06-25","2017-06-26","2017-06-27","2017-06-28","2017-06-29","2017-06-30","2017-07-01","2017-07-02","2017-07-03","2017-07-04","2017-07-05","2017-07-06","2017-07-07","2017-07-08","2017-07-09","2017-07-10","2017-07-11","2017-07-12","2017-07-13","2017-07-14","2017-07-15","2017-07-16","2017-07-17","2017-07-18","2017-07-19","2017-07-20","2017-07-21","2017-07-22","2017-07-23","2017-07-24","2017-07-25","2017-07-26","2017-07-27","2017-07-28","2017-07-29","2017-07-30","2017-07-31","2017-08-01","2017-08-02","2017-08-03","2017-08-04","2017-08-05","2017-08-06","2017-08-07","2017-08-08","2017-08-09","2017-08-10","2017-08-11","2017-08-12","2017-08-13","2017-08-14","2017-08-15","2017-08-16","2017-08-17","2017-08-18","2017-08-19","2017-08-20","2017-08-21","2017-08-22","2017-08-23","2017-08-24","2017-08-25","2017-08-26","2017-08-27","2017-08-28","2017-08-29","2017-08-30","2017-08-31","2017-09-01","2017-09-02","2017-09-03","2017-09-04","2017-09-05","2017-09-06","2017-09-07","2017-09-08","2017-09-09","2017-09-10","2017-09-11","2017-09-12","2017-09-13","2017-09-14","2017-09-15","2017-09-16","2017-09-17","2017-09-18","2017-09-19","2017-09-20","2017-09-21","2017-09-22","2017-09-23","2017-09-24","2017-09-25","2017-09-26","2017-09-27","2017-09-28","2017-09-29","2017-09-30","2017-10-01","2017-10-02","2017-10-03","2017-10-04","2017-10-05","2017-10-06","2017-10-07","2017-10-08","2017-10-09","2017-10-10","2017-10-11","2017-10-12","2017-10-13","2017-10-14","2017-10-15","2017-10-16","2017-10-17","2017-10-18","2017-10-19","2017-10-20","2017-10-21","2017-10-22","2017-10-23","2017-10-24","2017-10-25","2017-10-26","2017-10-27","2017-10-28","2017-10-29","2017-10-30","2017-10-31","2017-11-01","2017-11-02","2017-11-03","2017-11-04","2017-11-05","2017-11-06","2017-11-07","2017-11-08","2017-11-09","2017-11-10","2017-11-11","2017-11-12","2017-11-13","2017-11-14","2017-11-15","2017-11-16","2017-11-17","2017-11-18","2017-11-19","2017-11-20","2017-11-21","2017-11-22","2017-11-23","2017-11-24","2017-11-25","2017-11-26","2017-11-27","2017-11-28","2017-11-29","2017-11-30","2017-12-01","2017-12-02","2017-12-03","2017-12-04","2017-12-05","2017-12-06","2017-12-07","2017-12-08","2017-12-09","2017-12-10","2017-12-11","2017-12-12","2017-12-13","2017-12-14","2017-12-15","2017-12-16","2017-12-17","2017-12-18","2017-12-19","2017-12-20","2017-12-21","2017-12-22","2017-12-23","2017-12-24","2017-12-25","2017-12-26","2017-12-27","2017-12-28","2017-12-29","2017-12-30","2017-12-31","2018-01-01","2018-01-02","2018-01-03","2018-01-04","2018-01-05","2018-01-06","2018-01-07","2018-01-08","2018-01-09","2018-01-10","2018-01-11","2018-01-12","2018-01-13","2018-01-14","2018-01-15","2018-01-16","2018-01-17","2018-01-18","2018-01-19","2018-01-20","2018-01-21","2018-01-22","2018-01-23","2018-01-24","2018-01-25","2018-01-26","2018-01-27","2018-01-28","2018-01-29","2018-01-30","2018-01-31","2018-02-01","2018-02-02","2018-02-03","2018-02-04","2018-02-05","2018-02-06","2018-02-07","2018-02-08","2018-02-09","2018-02-10","2018-02-11","2018-02-12","2018-02-13","2018-02-14","2018-02-15","2018-02-16","2018-02-17","2018-02-18","2018-02-19","2018-02-20","2018-02-21","2018-02-22","2018-02-23","2018-02-24","2018-02-25","2018-02-26","2018-02-27","2018-02-28","2018-03-01","2018-03-02","2018-03-03","2018-03-04","2018-03-05","2018-03-06","2018-03-07","2018-03-08","2018-03-09","2018-03-10","2018-03-11","2018-03-12","2018-03-13","2018-03-14","2018-03-15","2018-03-16","2018-03-17","2018-03-18","2018-03-19","2018-03-20","2018-03-21","2018-03-22","2018-03-23","2018-03-24","2018-03-25","2018-03-26","2018-03-27","2018-03-28","2018-03-29","2018-03-30","2018-03-31","2018-04-01","2018-04-02","2018-04-03","2018-04-04","2018-04-05","2018-04-06","2018-04-07","2018-04-08","2018-04-09","2018-04-10","2018-04-11","2018-04-12","2018-04-13","2018-04-14","2018-04-15","2018-04-16","2018-04-17","2018-04-18","2018-04-19","2018-04-20","2018-04-21","2018-04-22","2018-04-23","2018-04-24","2018-04-25","2018-04-26","2018-04-27","2018-04-28","2018-04-29","2018-04-30","2018-05-01","2018-05-02","2018-05-03","2018-05-04","2018-05-05","2018-05-06","2018-05-07","2018-05-08","2018-05-09","2018-05-10","2018-05-11","2018-05-12","2018-05-13","2018-05-14","2018-05-15","2018-05-16","2018-05-17","2018-05-18","2018-05-19","2018-05-20","2018-05-21","2018-05-22","2018-05-23","2018-05-24","2018-05-25","2018-05-26","2018-05-27","2018-05-28","2018-05-29","2018-05-30","2018-05-31","2018-06-01","2018-06-02","2018-06-03","2018-06-04","2018-06-05","2018-06-06","2018-06-07","2018-06-08","2018-06-09","2018-06-10","2018-06-11","2018-06-12","2018-06-13","2018-06-14","2018-06-15","2018-06-16","2018-06-17","2018-06-18","2018-06-19","2018-06-20","2018-06-21","2018-06-22","2018-06-23","2018-06-24","2018-06-25","2018-06-26","2018-06-27","2018-06-28","2018-06-29","2018-06-30","2018-07-01","2018-07-02","2018-07-03","2018-07-04","2018-07-05","2018-07-06","2018-07-07","2018-07-08","2018-07-09","2018-07-10","2018-07-11","2018-07-12","2018-07-13","2018-07-14","2018-07-15","2018-07-16","2018-07-17","2018-07-18","2018-07-19","2018-07-20","2018-07-21","2018-07-22","2018-07-23","2018-07-24","2018-07-25","2018-07-26","2018-07-27","2018-07-28","2018-07-29","2018-07-30","2018-07-31","2018-08-01","2018-08-02","2018-08-03","2018-08-04","2018-08-05","2018-08-06","2018-08-07","2018-08-08","2018-08-09","2018-08-10","2018-08-11","2018-08-12","2018-08-13","2018-08-14","2018-08-15","2018-08-16","2018-08-17","2018-08-18","2018-08-19","2018-08-20","2018-08-21","2018-08-22","2018-08-23","2018-08-24","2018-08-25","2018-08-26","2018-08-27","2018-08-28","2018-08-29","2018-08-30","2018-08-31","2018-09-01","2018-09-02","2018-09-03","2018-09-04","2018-09-05","2018-09-06","2018-09-07","2018-09-08","2018-09-09","2018-09-10","2018-09-11","2018-09-12","2018-09-13","2018-09-14","2018-09-15","2018-09-16","2018-09-17","2018-09-18","2018-09-19","2018-09-20","2018-09-21","2018-09-22","2018-09-23","2018-09-24","2018-09-25","2018-09-26","2018-09-27","2018-09-28","2018-09-29","2018-09-30","2018-10-01","2018-10-02","2018-10-03","2018-10-04","2018-10-05","2018-10-06","2018-10-07","2018-10-08","2018-10-09","2018-10-10","2018-10-11","2018-10-12","2018-10-13","2018-10-14","2018-10-15","2018-10-16","2018-10-17","2018-10-18","2018-10-19","2018-10-20","2018-10-21","2018-10-22","2018-10-23","2018-10-24","2018-10-25","2018-10-26","2018-10-27","2018-10-28","2018-10-29","2018-10-30","2018-10-31","2018-11-01","2018-11-02","2018-11-03","2018-11-04","2018-11-05","2018-11-06","2018-11-07","2018-11-08","2018-11-09","2018-11-10","2018-11-11","2018-11-12","2018-11-13","2018-11-14","2018-11-15","2018-11-16","2018-11-17","2018-11-18","2018-11-19","2018-11-20","2018-11-21","2018-11-22","2018-11-23","2018-11-24","2018-11-25","2018-11-26","2018-11-27","2018-11-28","2018-11-29","2018-11-30","2018-12-01","2018-12-02","2018-12-03","2018-12-04","2018-12-05","2018-12-06","2018-12-07","2018-12-08","2018-12-09","2018-12-10","2018-12-11","2018-12-12","2018-12-13","2018-12-14","2018-12-15","2018-12-16","2018-12-17","2018-12-18","2018-12-19","2018-12-20","2018-12-21","2018-12-22","2018-12-23","2018-12-24","2018-12-25","2018-12-26","2018-12-27","2018-12-28","2018-12-29","2018-12-30","2018-12-31","2019-01-01","2019-01-02","2019-01-03","2019-01-04","2019-01-05","2019-01-06","2019-01-07","2019-01-08","2019-01-09","2019-01-10","2019-01-11","2019-01-12","2019-01-13","2019-01-14","2019-01-15","2019-01-16","2019-01-17","2019-01-18","2019-01-19","2019-01-20","2019-01-21","2019-01-22","2019-01-23","2019-01-24","2019-01-25","2019-01-26","2019-01-27","2019-01-28","2019-01-29","2019-01-30","2019-01-31","2019-02-01","2019-02-02","2019-02-03","2019-02-04","2019-02-05","2019-02-06","2019-02-07","2019-02-08","2019-02-09","2019-02-10","2019-02-11","2019-02-12","2019-02-13","2019-02-14","2019-02-15","2019-02-16","2019-02-17","2019-02-18","2019-02-19","2019-02-20","2019-02-21","2019-02-22","2019-02-23","2019-02-24","2019-02-25","2019-02-26","2019-02-27","2019-02-28","2019-03-01","2019-03-02","2019-03-03","2019-03-04","2019-03-05","2019-03-06","2019-03-07","2019-03-08","2019-03-09","2019-03-10","2019-03-11","2019-03-12","2019-03-13","2019-03-14","2019-03-15","2019-03-16","2019-03-17","2019-03-18","2019-03-19","2019-03-20","2019-03-21","2019-03-22","2019-03-23","2019-03-24","2019-03-25","2019-03-26","2019-03-27","2019-03-28","2019-03-29","2019-03-30","2019-03-31","2019-04-01","2019-04-02","2019-04-03","2019-04-04","2019-04-05","2019-04-06","2019-04-07","2019-04-08","2019-04-09","2019-04-10","2019-04-11","2019-04-12","2019-04-13","2019-04-14","2019-04-15","2019-04-16","2019-04-17","2019-04-18","2019-04-19","2019-04-20","2019-04-21","2019-04-22","2019-04-23","2019-04-24","2019-04-25","2019-04-26","2019-04-27","2019-04-28","2019-04-29","2019-04-30","2019-05-01","2019-05-02","2019-05-03","2019-05-04","2019-05-05","2019-05-06","2019-05-07","2019-05-08","2019-05-09","2019-05-10","2019-05-11","2019-05-12","2019-05-13","2019-05-14","2019-05-15","2019-05-16","2019-05-17","2019-05-18","2019-05-19","2019-05-20","2019-05-21","2019-05-22","2019-05-23","2019-05-24","2019-05-25","2019-05-26","2019-05-27","2019-05-28","2019-05-29","2019-05-30","2019-05-31","2019-06-01","2019-06-02","2019-06-03","2019-06-04","2019-06-05","2019-06-06","2019-06-07","2019-06-08","2019-06-09","2019-06-10","2019-06-11","2019-06-12","2019-06-13","2019-06-14","2019-06-15","2019-06-16","2019-06-17","2019-06-18","2019-06-19","2019-06-20","2019-06-21","2019-06-22","2019-06-23","2019-06-24","2019-06-25","2019-06-26","2019-06-27","2019-06-28","2019-06-29","2019-06-30","2019-07-01","2019-07-02","2019-07-03","2019-07-04","2019-07-05","2019-07-06","2019-07-07","2019-07-08","2019-07-09","2019-07-10","2019-07-11","2019-07-12","2019-07-13","2019-07-14","2019-07-15","2019-07-16","2019-07-17","2019-07-18","2019-07-19","2019-07-20","2019-07-21","2019-07-22","2019-07-23","2019-07-24","2019-07-25","2019-07-26","2019-07-27","2019-07-28","2019-07-29","2019-07-30","2019-07-31","2019-08-01","2019-08-02","2019-08-03","2019-08-04","2019-08-05","2019-08-06","2019-08-07","2019-08-08","2019-08-09","2019-08-10","2019-08-11","2019-08-12","2019-08-13","2019-08-14","2019-08-15","2019-08-16","2019-08-17","2019-08-18","2019-08-19","2019-08-20","2019-08-21","2019-08-22","2019-08-23","2019-08-24","2019-08-25","2019-08-26","2019-08-27","2019-08-28","2019-08-29","2019-08-30","2019-08-31","2019-09-01","2019-09-02","2019-09-03","2019-09-04","2019-09-05","2019-09-06","2019-09-07","2019-09-08","2019-09-09","2019-09-10","2019-09-11","2019-09-12","2019-09-13","2019-09-14","2019-09-15","2019-09-16","2019-09-17","2019-09-18","2019-09-19","2019-09-20","2019-09-21","2019-09-22","2019-09-23","2019-09-24","2019-09-25","2019-09-26","2019-09-27","2019-09-28","2019-09-29","2019-09-30","2019-10-01","2019-10-02","2019-10-03","2019-10-04","2019-10-05","2019-10-06","2019-10-07","2019-10-08","2019-10-09","2019-10-10","2019-10-11","2019-10-12","2019-10-13","2019-10-14","2019-10-15","2019-10-16","2019-10-17","2019-10-18","2019-10-19","2019-10-20","2019-10-21","2019-10-22","2019-10-23","2019-10-24","2019-10-25","2019-10-26","2019-10-27","2019-10-28","2019-10-29","2019-10-30","2019-10-31","2019-11-01","2019-11-02","2019-11-03","2019-11-04","2019-11-05","2019-11-06","2019-11-07","2019-11-08","2019-11-09","2019-11-10","2019-11-11","2019-11-12","2019-11-13","2019-11-14","2019-11-15","2019-11-16","2019-11-17","2019-11-18","2019-11-19","2019-11-20","2019-11-21","2019-11-22","2019-11-23","2019-11-24","2019-11-25","2019-11-26","2019-11-27","2019-11-28","2019-11-29","2019-11-30","2019-12-01","2019-12-02","2019-12-03","2019-12-04","2019-12-05","2019-12-06","2019-12-07","2019-12-08","2019-12-09","2019-12-10","2019-12-11","2019-12-12","2019-12-13","2019-12-14","2019-12-15","2019-12-16","2019-12-17","2019-12-18","2019-12-19","2019-12-20","2019-12-21","2019-12-22","2019-12-23","2019-12-24","2019-12-25","2019-12-26","2019-12-27","2019-12-28","2019-12-29","2019-12-30","2019-12-31"],"y":[0.0136763620536306,0.0162973336108851,0.0103570955471869,0.0797797248452964,0.0784891092481502,0.0782279582915429,0.0758927388679674,0.0684631833923131,0.0181821622542248,0.00997861589992998,0.0784474764869519,0.0714626345968245,0.0725696875650512,0.0702855628938554,0.0659406165433454,0.0178793785364192,0.00986696440398917,0.0744431618189732,0.0751641655469977,0.0762220161610809,0.0724391120867475,0.0654580549930927,0.0172492099237363,0.00993319834225915,0.0806067028745529,0.0762560793293341,0.075372329352989,0.0723482769714059,0.0651571636735234,0.0175198228715251,0.0100675586170354,0.0833784710253895,0.0761116182525463,0.0750339953107304,0.072715874957861,0.0649660804448367,0.0176567287988576,0.00919293806603613,0.0785376902885151,0.0758654126595128,0.0728295083084918,0.0705038123989137,0.0598147018829046,0.0158026112943975,0.00908498638293682,0.0732669967084206,0.0581518671853398,0.0709962235849807,0.0705682046309378,0.0642312514440905,0.0178858893892965,0.0101323070979179,0.0807478589582852,0.078128610226244,0.0740548546061279,0.0718598370497752,0.0647463893002837,0.0177646804819569,0.0103463165749393,0.0816626074308636,0.0792041095344917,0.0728687668172914,0.0724003951767202,0.0652800084951617,0.0177753674441889,0.0101828166391396,0.0807798861875876,0.0763237187570516,0.0766991745660925,0.0725027922155496,0.0655132461947174,0.017390430427849,0.0095361983013469,0.0820295093095974,0.0770518754776158,0.0753547393710926,0.0712607540593789,0.0635468438009022,0.0173525055986529,0.0096897938595909,0.0776662577105918,0.0741525222855778,0.0716115587294424,0.0673544966521857,0.0543367990306414,0.0151187331590055,0.00846671811801828,0.0745355630604579,0.074332665224259,0.0730261548584551,0.0701286979078768,0.0667239322900371,0.0172062339888541,0.00931798918021037,0.0753592849002687,0.0751374280150256,0.0741817368170553,0.0723215521638631,0.0658061653459545,0.017033678633665,0.00959673244628504,0.0813114965479448,0.0770336407094111,0.0749136749170881,0.072463768115942,0.0638492738453487,0.0169786884655278,0.00984703252194392,0.0808184812474046,0.0766107852785631,0.0764496071995404,0.0726021916426322,0.0656677418192644,0.0165482481839023,0.00928385735171143,0.082011199032173,0.0766714640847835,0.0732222531936962,0.0714530867498346,0.0638303117184048,0.01748118482954,0.012586147255262,0.0795519772529432,0.0768853562020322,0.0764425032406193,0.0720234769089243,0.0637005021534438,0.0163551490684883,0.00945196470861035,0.0810211847172013,0.07713814351477,0.0759426305846039,0.0728502624806608,0.0648009822592723,0.0166744593582623,0.00939494501400784,0.0819411024567886,0.078143590796261,0.0762714441568118,0.0721299136721824,0.0635522509474773,0.0160909578168299,0.00959641460160339,0.0815533685334915,0.0767371049960656,0.0752241824326122,0.0711624795204264,0.0623453340783907,0.0146597634823068,0.00949567980780562,0.0117213485537905,0.0781682993305888,0.0790598534372279,0.0738423100179115,0.06360497263832,0.0165710243802266,0.00932654900573854,0.0810297422792146,0.0775006750101727,0.075266486410429,0.0716347415376542,0.0616559996045011,0.015975874565997,0.00928091451519058,0.0781642765602242,0.0756144494008572,0.0740952011530315,0.0707714890914553,0.0618499461893299,0.0157515049874695,0.00947105822580706,0.0786434387109778,0.0739107617537335,0.073490544153271,0.0692997767712837,0.0616788168497751,0.0148939568525892,0.00904893918823847,0.0777307489000186,0.075127681501679,0.0738841416342472,0.0715415711194521,0.0602615415476611,0.0139138574990209,0.00874416116614288,0.0103661390621567,0.0720070304813396,0.074280474175399,0.0711435039689742,0.0637271103384374,0.0159312999703879,0.00941473153304613,0.0798933965057743,0.0759750494330719,0.0735774260414378,0.0706544270062185,0.0622847153896854,0.015566402705207,0.00915108848281066,0.0769455615310402,0.0742957578304852,0.0740244729527066,0.0699380056740569,0.0606417224679282,0.0148977427951895,0.00908422249180892,0.0767793517819787,0.0741314585383094,0.0728113328302464,0.0696246907447916,0.0601774814446875,0.0150123702083353,0.00954464260127809,0.0775598220584102,0.0730099618997004,0.0717348540316923,0.0682459906746984,0.0600944765080014,0.0153509987707731,0.00882634636670726,0.0780817177824976,0.0749522551439228,0.0727805571858159,0.0693777205965287,0.0601480042745745,0.0155784917787086,0.00956426486303583,0.0777701097128044,0.0743749199473134,0.073644648274781,0.0690794944684788,0.0610904753074501,0.0158098081985421,0.00916089490778886,0.0772252735173287,0.0753135675682909,0.0729506990152803,0.0700659347381823,0.06073298629498,0.0147641050444185,0.00930044944206862,0.0791388911723154,0.0748432879048276,0.074405507242498,0.0713387080454592,0.0600636489115349,0.0136404161042819,0.00896315655837697,0.0110001508177568,0.0780930526468516,0.0752103334981511,0.0731828846664159,0.0645232727071406,0.0170309520036807,0.00962560923691942,0.0801014106232973,0.0769056014478505,0.0762526941969527,0.0702753474058391,0.063089549474906,0.0174452235634609,0.0101200623889151,0.080918499229684,0.0776405993764927,0.0775585086987482,0.0733871568180126,0.0658481780642255,0.0175406778399079,0.00934879183522301,0.0814434977501427,0.0772626004417624,0.0772091460469521,0.0732306118046395,0.0650864529381781,0.0205860576592805,0.00932364457946279,0.0780220744822954,0.0777873613666028,0.0773255680820694,0.0744059659112594,0.0629947103678317,0.0167905748372274,0.00916716916900107,0.0770641396523956,0.0774381540481334,0.0772473303768386,0.07474944851959,0.0653666486020258,0.0183209806810115,0.00936944226057354,0.082968224042256,0.0799532100357985,0.0775774553281785,0.0749937028188473,0.0667921014265978,0.0173306058269916,0.00902595965224294,0.0815179641404157,0.0788235339017334,0.0769973513674424,0.0729366236422896,0.0666833319339597,0.0170958927112991,0.00878933829983742,0.0739708879407073,0.0794580776277994,0.0772017346636689,0.0747013546059001,0.0665101095366496,0.0174446515870412,0.00930141381489986,0.0822625039005929,0.0799201478624751,0.0755734871700498,0.0730591049839576,0.0691545114857458,0.0169545770957185,0.00847928885190549,0.0826845680543443,0.08035621414455,0.0801481825237436,0.0786479544890823,0.0699266288475848,0.0185088133396276,0.00935742232819388,0.0838587465294725,0.0803442123202727,0.0705487234059577,0.00736912010625615,0.0285563405637657,0.0145162064633824,0.00898536577559789,0.085398980645058,0.0822745057248702,0.0814523807618758,0.0791098525899663,0.0692387692564672,0.0178152771121712,0.00940775488533118,0.0839936923697958,0.079501593810091,0.0768349695654854,0.0729911331263932,0.0638995551649191,0.0165286955415077,0.00887085067500791,0.0791516118063247,0.0774355068674026,0.071732391033302,0.0678806004577606,0.0636649081396667,0.0153753457563688,0.00942962876056657,0.0828821018010154,0.0771471694211178,0.0732894132432395,0.0675982286138128,0.0500434494703539,0.0100599940741683,0.00648262120612548,0.0183303074472591,0.0682783072802222,0.070262864324306,0.0636947361513513,0.0558559346806315,0.0151088821853194,0.0124955408263218,0.0290136997640826,0.0790333102737391,0.0780912174480322,0.073459589539222,0.0663899515354339,0.0170463616099144,0.00981905116667751,0.0825967074052832,0.0779236904811177,0.0759902321923761,0.0757616071551753,0.0678267416399116,0.0175607679436163,0.00910558337817143,0.0788973177947144,0.0772949716288154,0.0760927192780179,0.0733728696975251,0.0667998998780009,0.0182032831343704,0.00985649837104661,0.0823739950845617,0.0739188105191168,0.0755526911729056,0.0734812694996462,0.0652645644988677,0.0171114014911871,0.0096712332546942,0.0802572425849608,0.0769835685609039,0.0761916945483173,0.0726156268451092,0.0657842944302303,0.0176933674473529,0.00918913599685101,0.0807518205077741,0.0766109033654792,0.0750580594371187,0.0669966542019288,0.0656957291871679,0.0177563471757528,0.00949025782326314,0.0772131470183035,0.0757508364495178,0.0742944302302696,0.0727081283211966,0.0658728596732927,0.0177740602243653,0.00993505215508758,0.0755481204487306,0.0752706160204684,0.073999212753395,0.0703857508364495,0.0634127140326707,0.0170360165321787,0.00938988388112576,0.0816591222200354,0.0795060027553631,0.0776737462383211,0.0727303880634641,0.0652582363043376,0.0163977689895855,0.00892364776505065,0.0803344940049473,0.0765944791945674,0.0735989223085286,0.0709972585041516,0.0648781294805338,0.0162776315996786,0.00880744930596039,0.0813487686902267,0.0502115205848525,0.0551982069986923,0.070331579196143,0.064752083694402,0.0165671430147001,0.0087680599977942,0.0820636846334431,0.0776954103578125,0.074944067182404,0.0730317162709354,0.0641238242291512,0.0163662575430525,0.00950660952591029,0.0815772266775906,0.077705257684854,0.0754305251382565,0.0728229529376546,0.0637220532858561,0.0194230090380394,0.00938709747396362,0.0820483593286253,0.07835662687668,0.0754182287178132,0.0727243683923018,0.0650253708002106,0.0169342449598583,0.00970460224146533,0.0770984402824806,0.0732292206934225,0.0712630576300734,0.0688275396930261,0.0565986759459571,0.0149345565483879,0.00831034217547956,0.0769603947313929,0.0775658230768776,0.078348738559475,0.0747674425483997,0.0660962098607909,0.0167488695055406,0.00934962796723982,0.0806363505489283,0.0766369737259875,0.0746412294731196,0.0729353808775358,0.0650687565448382,0.0159935631331607,0.00992744720250691,0.0820891098499818,0.0773170616038825,0.0757738029371315,0.0720411324870769,0.0630266049099733,0.0169205172386538,0.00932278410977094,0.0807987796202912,0.0769218609209757,0.0750367536635103,0.0728275818460614,0.0636589260026241,0.0164186123713622,0.00836837446055107,0.0817116931978059,0.077085869204382,0.0764239080605131,0.0725133973031506,0.0638051502552996,0.0162506520811268,0.0095065524273226,0.0823835343587474,0.0782161431574954,0.0760919394868714,0.0730232061841003,0.0634672536714144,0.0148160736021752,0.0095243364580534,0.0113699236472281,0.0808343476817528,0.0776549581877678,0.077772492121068,0.0657667836118214,0.016604229846782,0.00919506055380468,0.0811559731224356,0.078359200015857,0.0759628154050465,0.0724445501575786,0.0636677171909377,0.015884719827159,0.00902459812491328,0.0800221997581812,0.07659907633149,0.0753939466016531,0.0722701234861549,0.0635190580959743,0.0161404134704961,0.00877881508790708,0.0799825573328576,0.0769023408852154,0.0742066559632118,0.0719767695387604,0.0625141226140215,0.0149015876791342,0.00894927751679848,0.0778874551545064,0.0771619987710848,0.0749935581058849,0.0728607956234762,0.0634318447602624,0.0172056388862941,0.00895361016319222,0.0547332897412099,0.00918813313750002,0.0706589896829766,0.0732089301578658,0.0634941140695897,0.0149836330788693,0.00853226380257141,0.0806460909193897,0.0769096231931297,0.0758304200147471,0.071785892449354,0.0631820792647903,0.015641489896631,0.00918018320616756,0.0796424120886656,0.0760709054375543,0.0743417953727425,0.071463920230389,0.061035597805024,0.0150174202870323,0.00899534730268767,0.0776847414980453,0.0747532043191977,0.0734454406150067,0.0710664236637656,0.0610991972556837,0.0149021462827115,0.00904304689068248,0.0752977746154718,0.0760158785718831,0.0733488990008273,0.0707555049958633,0.0596361293196716,0.0150512314643925,0.00879446954750843,0.0771156844650926,0.0754570260294024,0.0736830172468656,0.0706282218545154,0.0612808661617769,0.0151029402405651,0.00841063132438109,0.0780185992490295,0.0757056259148476,0.0737128492331191,0.0704969611150003,0.0616766371794056,0.0154191592948514,0.00862542162540571,0.0760954305352256,0.0749558486603449,0.0739375835295615,0.0710657576528989,0.062241456119137,0.0146872812321008,0.00893368548335773,0.0777898873544199,0.0742736905746834,0.0726349201298288,0.0706540762426017,0.0630201998284,0.0138753132894446,0.00865365665268518,0.0111380742976245,0.0734117544009826,0.0751974295832827,0.0746300745922509,0.0650089283759115,0.0168534293125449,0.00938823206212637,0.0798318240363426,0.0766287567360963,0.07497048758687,0.073139025861434,0.0650188819722454,0.0168454664354778,0.00955545248053574,0.0811795409799515,0.0784343391110642,0.0780063344687069,0.0728941673916203,0.0650786035502487,0.0171201856942932,0.00927277034465323,0.0824297126794882,0.0786851697386783,0.0770149562738513,0.0748769237813314,0.065749475943153,0.0172057866227647,0.0118815159354325,0.0809766099484011,0.0774442673730022,0.0766364758749579,0.0733275225533392,0.0638554192836784,0.0165547393426372,0.00902333021519167,0.0770254125221644,0.0777434494093149,0.0778332040202087,0.0743048505386274,0.0650361910536593,0.0170932670080001,0.00896748290174662,0.082630089335756,0.0805876733011945,0.0792493323254223,0.0748693073138041,0.0659357317095062,0.0176377783140893,0.00924472492206308,0.0827657185255511,0.0798038163660552,0.0786210500491656,0.0760839863812337,0.0673518600147198,0.0171271743054489,0.0083272333440374,0.0810922936691087,0.0708582734803048,0.0797001581899238,0.0755616541233242,0.0665656008820287,0.0177564194749373,0.00911389674512248,0.0818612882092581,0.0804311873831552,0.0766721793458287,0.0747127814262659,0.0680056884457441,0.0166718597702251,0.00916383043318473,0.0831156224533819,0.0796382404167266,0.0785277151942221,0.0771894923541537,0.0684870491986642,0.0168256555294569,0.00939951744083857,0.0856023201188821,0.0794664685297924,0.0697134205774731,0.00722240864132432,0.0295687327229439,0.0144068676797213,0.00888220443251362,0.082887924835818,0.0808006966748158,0.0794984260901523,0.0781242509946791,0.0700488244693911,0.0171710788476942,0.00959583965609541,0.0837744172660712,0.0802021405484602,0.0743999581389545,0.0729086583937434,0.0635563373195246,0.0165149874618119,0.00904440088391207,0.082250916716645,0.0724538220342053,0.0754907603817405,0.0742953055252555,0.0656514021437685,0.0169496983187155,0.00925773121183701,0.0842654795303513,0.0792562419246421,0.0758489943286333,0.0707693174637037,0.0562568175140174,0.0142448307646483,0.00909471464049815,0.00675814378464102,0.0473613453496001,0.0666576772754899,0.0671749026931948,0.0594004210255151,0.0158629211764564,0.0104109225127898,0.0138753864788194,0.0701757880980461,0.0781105568482453,0.0706160552067064,0.0637968954196283,0.0167480795588563,0.00962212730691996,0.0809354381155771,0.0817761291556434,0.0790110126541931,0.0771403754821025,0.0670899340196985,0.0149372071526472,0.00954044879354859,0.0767499123450101,0.0784392630605935,0.0738831957415612,0.0741063175341855,0.0682653077487011,0.0183955949383228,0.0106062537851018,0.0845751123577599,0.080437398399898,0.0779053644853855,0.0759510566410608,0.0689346731265738,0.0181465750804832,0.010584340037612,0.0840093392407484,0.0765247983935231,0.0775348229369203,0.0785753278371712,0.0667429063248367,0.0180006614520866,0.0099715894374868,0.0818447340843073,0.0789419157405673,0.0664081956304316,0.073985009742472,0.0675199132939915,0.0178432677326937,0.0107346501277081,0.0847854066137239,0.0783940262110351,0.0746444695034726,0.0755151157740384,0.0671692639950909,0.0174966030849169,0.00989588106613326,0.0767563345991242,0.0763499001844894,0.0746185692711675,0.0698469495503321,0.0636966405406375,0.0169965293688711,0.00959503990628101,0.0822651147778756,0.078643066906277,0.0794061275964983,0.0777954846746474,0.0473767243396072,0.0170759359272493,0.00946774667629104,0.0822844163089185,0.0792791315666871,0.0730406163333127,0.0729646344170087,0.0674799397743337,0.0170819344995891,0.00952773239968887,0.084049996100928,0.0753020781054109,0.0739583979012995,0.0742183360360234,0.0659143123936503,0.0165840529953871,0.00986765149894325,0.0825303577748496,0.078343354281681,0.0756519948252316,0.0741103617339073,0.0661002681361836,0.0163041196195306,0.00924979854794559,0.0821524477174432,0.0780454251888051,0.0771676341030835,0.0719748699809445,0.0577522549633187,0.0148004774863582,0.0108677394090135,0.0719375540098316,0.070676734335378,0.0694523428377145,0.0692621068033668,0.0620756370377416,0.0162449430607359,0.00960489594696057,0.0832565980535211,0.0791381902886528,0.0777195151814427,0.0744005035183548,0.0676187912726184,0.0169451735701435,0.00940049339941674,0.0806378168998407,0.0777458244202355,0.0779360604545832,0.0743094330763798,0.066855823347628,0.0161255395923687,0.00917787676347792,0.0823479174213708,0.078464269018038,0.0767946442484968,0.0739674129720738,0.0653541729488407,0.0163036329011198,0.00919001948907458,0.0828032696312457,0.0814271549565369,0.0749122525989655,0.0739714139142742,0.0654693953692082,0.0163997915555673,0.0093718887944896,0.0829884605324255,0.0782802117698108,0.0775096973297619,0.0748372288245397,0.065702577370802,0.0158989571695355,0.00823031082146978,0.0836373147977298,0.0793062125768233,0.0780916384989568,0.0734969392327704,0.0643237620570302,0.015939510561117,0.00903124030520482,0.0827978595919923,0.0782295200303339,0.0773616774504894,0.0735699353376171,0.062930753056205,0.0146397743609292,0.00908598738383988,0.01130223023377,0.0824409897460749,0.0808188540828141,0.0759483917538734,0.0685544085183742,0.0165988994935723,0.00922161082976237,0.0834205784962992,0.0801194650045449,0.0775751525775873,0.0757653226853655,0.0643524379950656,0.0152110927152318,0.00904712050383067,0.0825542137384755,0.079435706401766,0.0776035579794832,0.0745925853785223,0.0645817101675107,0.0149818205427867,0.00873669004025451,0.0815600246721205,0.0782852876249838,0.0763111121932217,0.0730343461888067,0.06238232047786,0.0153247143228152,0.00928450850538891,0.0807667023763148,0.0791658550837554,0.0777313822880145,0.0741056356317361,0.0640399785742111,0.0158684748733931,0.0120744962534772,0.0761417612005105,0.0715278468196657,0.010437104474523,0.065453062450163,0.0609405973740862,0.0153979754776741,0.00931913313598062,0.0824356760683119,0.0798284289357765,0.0778927762008047,0.0756020508991452,0.0638745112679743,0.0156434827952124,0.00923391571997557,0.0806217624990616,0.0782904574754949,0.0764643699896725,0.0733823401108232,0.0628011776235298,0.0151423232296589,0.00890927794471825,0.0796762549786246,0.0780388631996705,0.0759591524519282,0.0724145137433373,0.0620565397265333,0.0146837723721079,0.0088727561950018,0.0788037909576206,0.0777263993409853,0.0767449762060259,0.0713920949887185,0.0611542773203448,0.0149009889910907,0.00887060513396445,0.0797540645072033,0.0772576809064294,0.0749850969764665,0.0718193489057213,0.0623872100522674,0.0149884743169532,0.00910457751708507,0.0807937157052436,0.0794142959160629,0.0769545340796035,0.0738213386882491,0.0631481289330249,0.015318070195784,0.00871597990685865,0.082156859154729,0.0788446240267257,0.0763014459493277,0.0735039500641898,0.0626761150818598,0.015018992453882,0.0088868814736598,0.0816522926241732,0.0785068899780473,0.0776279676344985,0.0742384198929424,0.0632742705656638,0.0167796655071294,0.008895219812803,0.0110634933250189,0.0786325204345514,0.077636011273392,0.0760322225007285,0.0678094935328797,0.0168754445062593,0.00877906230322001,0.0810412603701145,0.0797879819772454,0.0794578501079042,0.0769920503430722,0.0653049745981867,0.0172993175236849,0.00948415876489924,0.0838901761314658,0.0819970125103676,0.0787323751357718,0.0776930711026608,0.0671899868151037,0.0172789390132318,0.00904805864120168,0.0832808586689165,0.0813612029842291,0.0801629465695834,0.0764173763482932,0.0666091992671888,0.0175622003085306,0.00976742006019812,0.0858881838840787,0.0805286993068509,0.0812047437140088,0.0778469207399021,0.0663541658182174,0.0169153641272918,0.00893315305482476,0.0799055981363981,0.0810296237772149,0.0820803433979784,0.0794759434077525,0.0668225098352244,0.0179273944596939,0.00894129816816401,0.0853709691870362,0.0827869319801585,0.082269717283116,0.0774396650729395,0.0676655290658369,0.0176667508328378,0.00874988800469158,0.0850451646534661,0.0840758961660951,0.0822086289330716,0.0788263706189472,0.0688547156133678,0.0169703436423318,0.00872545266467383,0.08358718936574,0.080711964356984,0.073230677754881,0.0790656910502823,0.0688054134480158,0.017446955954589,0.00868271406151275,0.0845056356113568,0.0849071601818071,0.0802030043005931,0.0790228889387114,0.0677638953997921,0.0168477263925973,0.00933289851823166,0.085744858651122,0.0813056682224894,0.0798320526669792,0.076566863012861,0.0631453437417198,0.0172553655504148,0.00954690907608585,0.0881336241159326,0.0820312659234046,0.0721704746957993,0.00726820618388602,0.0295253042007215,0.0141797281046817,0.00894360312251595,0.0854758168069625,0.0800338340500989,0.0756598658867171,0.0788435277092717,0.0701873101930171,0.0199996337436083,0.00937819838480931,0.0849816566590499,0.0818562687833573,0.0800168477940174,0.0728178749397203,0.0661194524873896,0.0163675911927546,0.00889799556015863,0.0849450310198816,0.0815184989999166,0.0795671663353403,0.0773675932275124,0.0690067737084884,0.0175701330121129,0.00918286164257853,0.086711200730885,0.0825765730203333,0.0803342700001424,0.0768141391245251,0.066705462714082,0.0164123558628492,0.0108635715288559,0.0277622344895505,0.00668214439047815,0.0565215002675706,0.0710150795895487,0.0652465414205458,0.0165425803576697,0.0103976120083262,0.0530746206702899,0.0143758822670409,0.0788320812578086,0.0803775697295192,0.0729746393860233,0.01835926725187,0.00975969885285003,0.0874377342571109,0.083251529262871,0.0813328519738443,0.0788117992568675,0.0704353328681994,0.017424267008486,0.00948386364005127,0.0854257597637552,0.0807771251480586,0.0792661160779478,0.0781911700280703,0.0669955055085914,0.0157307199299054,0.00782276776297642,0.0682448767665623,0.0783595106358813,0.0780593370219532,0.075138728886437,0.0638801901640408,0.0163087569567263,0.00942707403741623,0.0837666920867745,0.0721167107462154,0.0400569518586426,0.0448374194804563,0.0686614765991634,0.0183993087105306,0.00932512258448363,0.0844117867282945,0.0817830249580592,0.0770941558113039,0.0784115722180962,0.0677953410813338,0.0175797178583787,0.00967319573650862,0.0858870502621679,0.0727695492655049,0.0736802057678959,0.0741294629757421,0.0674594100160073,0.0176384046107551,0.00976426138674772,0.076527525098705,0.0792048552157345,0.0754954477293286,0.0732329722411661,0.0664495931389115,0.016970589842335,0.00895478894017796,0.0748073961497443,0.0780452859360233,0.0753679558189939,0.0776243602638071,0.0694913346837722,0.0175014468988135,0.00975852866467316,0.0824812706986914,0.0802727404263529,0.0791815375711392,0.0778913861290634,0.0683539114497926,0.0175336002057812,0.00966608790714125,0.0852625317513906,0.081703562586412,0.0804817369216424,0.0770835342915019,0.0681007041574226,0.0173306324555481,0.00984293109546317,0.0833494099868171,0.0816131314105656,0.0787856499791004,0.076392238191698,0.0675741937558278,0.0166714896627118,0.0117339474614964,0.0843481720844989,0.080939921545931,0.0782048808719977,0.0760867817755056,0.0661735153210508,0.0172482396064435,0.00977460531815697,0.0867166181120439,0.0796469581013371,0.0787106191265782,0.0758234068703622,0.0672780605953672,0.0174074838947691,0.00962203584554217,0.0835406846302063,0.0806334222888776,0.0787066091095557,0.0767838059472562,0.0660449803609416,0.0169162568095102,0.00918293898157598,0.0846093541667084,0.0801722703312875,0.0770224019600963,0.0751096238403532,0.0602805808910659,0.015003478689767,0.00749071179807158,0.075983807551263,0.074032934269806,0.0737943382569659,0.0714264232051665,0.0628249366918563,0.0157994670687377,0.00959396572638451,0.0844970736900778,0.0826444458256725,0.0813160713173372,0.0765055871141716,0.0666937264775561,0.0165593986291928,0.00970536286603585,0.0848124132193874,0.0821781004414634,0.0798311307049148,0.0769818129939337,0.0671820087087045,0.0164589290343064,0.00882323982293239,0.0861386118718892,0.0825940445642935,0.0800581919893583,0.0769114842775131,0.0660607680297711,0.0160650882223513,0.00932357840546715,0.0843341779477277,0.0808679769241435,0.0799356190835967,0.0766783948173764,0.0661753033679418,0.0151166552466227,0.00971139104172904,0.0113691393573563,0.0844045066641482,0.0839825343656249,0.0810287282759618,0.0677627229671485,0.0189212064324882,0.00912165008002503,0.0856408219914399,0.0820627604824767,0.0815573392379371,0.0787614772740948,0.0655904403181747,0.0157964195317232,0.00939842838060627,0.0843532012017794,0.0822492849893902,0.0787514490747983,0.0774237154879521,0.0662904086290649,0.0161514177868165,0.00871851646830888,0.0833664263910115,0.0800731657420667,0.078643144522397,0.076146122897588,0.0637994039238338,0.0153752351612735,0.00877066310465028,0.0816455873917456,0.0783523267428008,0.0770286044356731,0.0765071380722592,0.066531085412179,0.0150463102243509,0.00962105440498682,0.0837588326396283,0.0760655631916884,0.0729680895686123,0.00968565482528313,0.0471638757138709,0.0142270028716162,0.0094517310360404,0.082448052786113,0.0798950569483432,0.0798305262478624,0.0756158648727132,0.0650913109411803,0.015840270383635,0.00892741909463427,0.0822524441002807,0.0784834478753267,0.0786770399767689,0.0747346174942729,0.0641052011744588,0.0155881973348821,0.00936300132287936,0.0814256445003711,0.0798748911044429,0.0769609266608589,0.0727805472203401,0.0622317942761269,0.0153341077017391,0.00917545897460717,0.0799979027522344,0.0779692188558707,0.0769770593359791,0.0742938149742728,0.0616119677864926,0.0154464090986195,0.00936598841670773,0.0798936178805968,0.077793439365423,0.0768887470819635,0.0743241060105494,0.0627509107504907,0.0155635344388888,0.00886719601935395,0.082629908157578,0.0798491910273912,0.0777267990856146,0.0747320252990735,0.0629306375657315,0.0154342926841089,0.00906913626119759,0.0831488945791161,0.0799986268063555,0.0772784917487217,0.074938004345754,0.0628417838593203,0.0151737897721306,0.00845927673082981,0.0821553485892455,0.0804772251795249,0.0785224436384785,0.0735890435302385,0.063469818011454,0.0145477750224154,0.0115813499844147,0.0110323469377495,0.0772224065639046,0.0793339567433863,0.0779302786240737,0.0698681789387952,0.0174675474847415,0.00869757573929394,0.0836234201079907,0.0803555448302213,0.0802087418177431,0.0766351945139915,0.0653635385559008,0.0164077503946588,0.00902335776698541,0.0840236091420068,0.0810191748866299,0.0800800378068032,0.0769549435411702,0.0662584336319669,0.0171296994560245,0.00937930479724091,0.0858093772937971,0.0818758609594482,0.0810272188873136,0.078042894633646,0.0666767216675213,0.0173830854775623,0.00894291776014801,0.0820870159773964,0.0828845327453744,0.0802218500624505,0.0775009337461897,0.0675329421639618,0.0173817355229179,0.00836355458097889,0.0852098619662084,0.0807881219452443,0.0791535640991659,0.077759973011723,0.0666574296075856,0.0173375582838347,0.00864468246605381,0.0807318963682293,0.0816957634027719,0.0806816949601802,0.0783925107531416,0.0684767286352848,0.0179721040815753,0.0088334397603184,0.0875271589617546,0.0827881460419202,0.0828343313373254,0.0790270565508821,0.0683261244111375,0.0174098483114254,0.00912059181435921,0.0863042526616787,0.0832259023201083,0.0820933585545207,0.07084422703888,0.0673638244543045,0.0170596958915051,0.0085288445522758,0.0860309566955443,0.0846904230106219,0.0806708287428082,0.0769663000266903,0.0679237180143245,0.0170897976958072,0.00882785580834382,0.0821979936144039,0.0751642053424682,0.0799323311439288,0.0787182250370754,0.0693144213730838,0.0171038452044816,0.0089502698125059,0.0870724791243987,0.0826053713659597,0.0824628894922628,0.0790373041626782,0.0701873736978461,0.0169994922829008,0.00913288742527227,0.0893200805122926,0.0810661657726431,0.0723547036076009,0.00740905743223582,0.0306556775013094,0.014828148799239,0.0111162019243274,0.0743421013142968,0.0820130009143456,0.0803803837850708,0.0782035609460376,0.0674835087663137,0.0162461410413136,0.00902541160558691,0.0857984318072231,0.0816748731020326,0.074774264672046,0.0768770595285018,0.067397476246021,0.0166402900296312,0.00906142521873268,0.0864546798689905,0.0806544873962358,0.0791599224506864,0.0770771351570894,0.0671733915420029,0.0155698854166875,0.00981971185107971,0.0793459927852728,0.0301173843712924,0.00703265834485436,0.0497388012668789,0.0596705554699677,0.016014053312152,0.010201856301682,0.0783576191800501,0.0515594894870261],"mode":"lines","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="configure-rocv-splits" class="section level2">
<h2>Configure ROCV splits</h2>
<p>To configure the ROCV strategy, decide on values for the following:</p>
<ol style="list-style-type: decimal">
<li><p>Size of the initial training set, i.e. how much of the available data to use as training data in the first ROCV iteration.</p></li>
<li><p>Desired forecast horizon, e.g. 1 day, 7 days, 30 days, etc.</p></li>
<li><p>The number of observations to shift forward after each ROCV iteration.</p></li>
<li><p>Whether or not to accumulate training observations.</p></li>
</ol>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">initial_train_obs &lt;-<span class="st"> </span><span class="dv">365</span><span class="op">*</span><span class="dv">3</span>       <span class="co"># 1</span></a>
<a class="sourceLine" id="cb3-2" title="2">forecast_horizon &lt;-<span class="st"> </span><span class="dv">30</span>           <span class="co"># 2</span></a>
<a class="sourceLine" id="cb3-3" title="3">shift &lt;-<span class="st"> </span><span class="dv">29</span>                      <span class="co"># 3</span></a>
<a class="sourceLine" id="cb3-4" title="4">accumulate_train_obs &lt;-<span class="st"> </span><span class="ot">TRUE</span>     <span class="co"># 4</span></a></code></pre></div>
<p>The first training iteration uses the first 3 years of data for training and 30 days for testing. For each subsequent training iteration, the training and testing sets shift forward by 30 days.</p>
<p>Note that <code>shift = 29</code> because the <code>rsample::rolling_origin()</code> resampling function adds a shift of 1 by default. Setting the shift parameter to 29 means that 30 total days will be added to each subsequent training sample.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">rocv_splits &lt;-<span class="st"> </span>rsample<span class="op">::</span><span class="kw">rolling_origin</span>(</a>
<a class="sourceLine" id="cb4-2" title="2">  <span class="dt">data =</span> claims,</a>
<a class="sourceLine" id="cb4-3" title="3">  <span class="dt">initial =</span> initial_train_obs,</a>
<a class="sourceLine" id="cb4-4" title="4">  <span class="dt">assess =</span> forecast_horizon,</a>
<a class="sourceLine" id="cb4-5" title="5">  <span class="dt">cumulative =</span> accumulate_train_obs,</a>
<a class="sourceLine" id="cb4-6" title="6">  <span class="dt">skip =</span> shift</a>
<a class="sourceLine" id="cb4-7" title="7">)</a>
<a class="sourceLine" id="cb4-8" title="8"></a>
<a class="sourceLine" id="cb4-9" title="9">rocv_splits</a></code></pre></div>
<pre><code>## # Rolling origin forecast resampling 
## # A tibble: 12 x 2
##    splits            id     
##    &lt;list&gt;            &lt;chr&gt;  
##  1 &lt;split [1.1K/30]&gt; Slice01
##  2 &lt;split [1.1K/30]&gt; Slice02
##  3 &lt;split [1.2K/30]&gt; Slice03
##  4 &lt;split [1.2K/30]&gt; Slice04
##  5 &lt;split [1.2K/30]&gt; Slice05
##  6 &lt;split [1.2K/30]&gt; Slice06
##  7 &lt;split [1.3K/30]&gt; Slice07
##  8 &lt;split [1.3K/30]&gt; Slice08
##  9 &lt;split [1.3K/30]&gt; Slice09
## 10 &lt;split [1.4K/30]&gt; Slice10
## 11 &lt;split [1.4K/30]&gt; Slice11
## 12 &lt;split [1.4K/30]&gt; Slice12</code></pre>
</div>
<div id="visualize-rocv-strategy" class="section level2">
<h2>Visualize ROCV strategy</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">cv_idx &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="kw">length</span>(rocv_splits<span class="op">$</span>splits), <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb6-2" title="2"></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="kw">map2</span>(rocv_splits<span class="op">$</span>splits, cv_idx, <span class="cf">function</span>(split, idx) {</a>
<a class="sourceLine" id="cb6-4" title="4">  train &lt;-<span class="st"> </span><span class="kw">analysis</span>(split) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">Split =</span> <span class="st">&quot;Training&quot;</span>)</a>
<a class="sourceLine" id="cb6-5" title="5">  test &lt;-<span class="st"> </span><span class="kw">assessment</span>(split) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">Split =</span> <span class="st">&quot;Testing&quot;</span>)</a>
<a class="sourceLine" id="cb6-6" title="6">  model_df &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(train, test) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">Idx =</span> idx)</a>
<a class="sourceLine" id="cb6-7" title="7">}) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="st">  </span><span class="kw">bind_rows</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> ds, <span class="dt">y =</span> y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>Idx, <span class="dt">ncol =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> Split, <span class="dt">group =</span> Split)) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-12" title="12"><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;steelblue&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-13" title="13"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;12-fold rolling origin cross validation strategy&quot;</span>,</a>
<a class="sourceLine" id="cb6-14" title="14">       <span class="dt">subtitle =</span> <span class="st">&quot;30-day forecasts using 30-day shifts with accumulating training data&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-15" title="15"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="/post/2020-06-28-rolling-origin-cross-validation-in-r-with-facebook-prophet-and-rsample_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
<div id="run-rocv" class="section level2">
<h2>Run ROCV</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">rocv &lt;-<span class="st"> </span><span class="kw">map2</span>(rocv_splits<span class="op">$</span>splits, cv_idx, <span class="cf">function</span>(split, id) {</a>
<a class="sourceLine" id="cb7-2" title="2">  </a>
<a class="sourceLine" id="cb7-3" title="3">  training &lt;-<span class="st"> </span><span class="kw">analysis</span>(split)</a>
<a class="sourceLine" id="cb7-4" title="4">  testing &lt;-<span class="st"> </span><span class="kw">assessment</span>(split)</a>
<a class="sourceLine" id="cb7-5" title="5">  </a>
<a class="sourceLine" id="cb7-6" title="6">  prophet_fit &lt;-<span class="st"> </span><span class="kw">prophet</span>(<span class="dt">df =</span> training,</a>
<a class="sourceLine" id="cb7-7" title="7">                         <span class="dt">daily.seasonality =</span> F,</a>
<a class="sourceLine" id="cb7-8" title="8">                         <span class="dt">yearly.seasonality =</span> F,</a>
<a class="sourceLine" id="cb7-9" title="9">                         <span class="dt">weekly.seasonality =</span> T) </a>
<a class="sourceLine" id="cb7-10" title="10">  </a>
<a class="sourceLine" id="cb7-11" title="11">  eval_df &lt;-<span class="st"> </span><span class="kw">predict</span>(prophet_fit, testing) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-12" title="12"><span class="st">    </span><span class="kw">select</span>(ds, </a>
<a class="sourceLine" id="cb7-13" title="13">           <span class="dt">Predicted =</span> yhat) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-14" title="14"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">Actual =</span> testing<span class="op">$</span>y) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-15" title="15"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">Iteration =</span> id)</a>
<a class="sourceLine" id="cb7-16" title="16">  </a>
<a class="sourceLine" id="cb7-17" title="17">  mae &lt;-<span class="st"> </span>yardstick<span class="op">::</span><span class="kw">mae_vec</span>(<span class="dt">truth =</span> eval_df<span class="op">$</span>Actual, </a>
<a class="sourceLine" id="cb7-18" title="18">                            <span class="dt">estimate =</span> eval_df<span class="op">$</span>Predicted) </a>
<a class="sourceLine" id="cb7-19" title="19">  </a>
<a class="sourceLine" id="cb7-20" title="20">  output &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">eval_df =</span> eval_df,</a>
<a class="sourceLine" id="cb7-21" title="21">                 <span class="dt">mae =</span> mae)</a>
<a class="sourceLine" id="cb7-22" title="22">  </a>
<a class="sourceLine" id="cb7-23" title="23">  <span class="kw">return</span>(output)</a>
<a class="sourceLine" id="cb7-24" title="24">})</a></code></pre></div>
</div>
<div id="results" class="section level2">
<h2>Results</h2>
<div id="distribution-of-mae" class="section level3">
<h3>Distribution of MAE</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">map_dbl</span>(rocv, <span class="cf">function</span>(x) x[[<span class="st">&#39;mae&#39;</span>]]) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="st">  </span><span class="kw">enframe</span>(<span class="dt">name =</span> <span class="st">&quot;Iteration&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;MAE&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Iteration, <span class="dt">y =</span> MAE)) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Mean absolute error across all ROCV iterations&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-6" title="6"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="/post/2020-06-28-rolling-origin-cross-validation-in-r-with-facebook-prophet-and-rsample_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="visualize-predictions" class="section level3">
<h3>Visualize predictions</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">map</span>(rocv, <span class="cf">function</span>(x) x[[<span class="st">&#39;eval_df&#39;</span>]]) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="st">  </span><span class="kw">bind_rows</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="st">  </span><span class="kw">gather</span>(key, value, <span class="op">-</span>ds, <span class="op">-</span>Iteration)  <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> ds, <span class="dt">y =</span> value)) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-5" title="5"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>Iteration, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">scales =</span> <span class="st">&quot;free_x&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-6" title="6"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> key, <span class="dt">group =</span> key), <span class="dt">lwd =</span> <span class="fl">1.05</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-7" title="7"><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;steelblue&quot;</span>, <span class="st">&quot;orange3&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-8" title="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Actual v. predicted fore each ROCV iteration&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-9" title="9"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="/post/2020-06-28-rolling-origin-cross-validation-in-r-with-facebook-prophet-and-rsample_files/figure-html/unnamed-chunk-9-1.png" width="864" /></p>
</div>
</div>
<div id="conclusion" class="section level2">
<h2>Conclusion</h2>
<p>ROCV is a great strategy for rigorously testing forecast models and measuring accuracy under changing conditions. The basic approach shown in this post can be extended to compare multiple models on the same data set by adding new models (e.g. Arima, XGBoost, LSTM) within the <code>rocv</code> object.</p>
</div>

</main>

  <footer>
  <script src="//yihui.name/js/math-code.js"></script>
<script async src="//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>

<script async src="//yihui.name/js/center-img.js"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-143402170-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-143402170-1');
</script>


  
  <hr/>
  <a href="https://github.com/dannymorris">GitHub</a> | <a href="https://www.linkedin.com/in/drmorris87/">LinkedIn</a> | <a href="mailto:drmorris87@outlook.com">Email</a>
  
  </footer>
  </body>
</html>

